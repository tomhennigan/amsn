# Directories in which the Tcl core can be found
TCL_INC_SPEC    = @TCL_INC_SPEC@
TCL_STUB_LIB_SPEC = @TCL_STUB_LIB_SPEC@

# Directories in which the Tk core can be found
TK_INC_SPEC     = @TK_INC_SPEC@
TK_STUB_LIB_SPEC = @TK_STUB_LIB_SPEC@

DEFINES         = @TCL_DEFS@
SHLIB_LD        = @SHLIB_LD@

NAME		= @NAME@
OUTPUT		= @WEBCAMSN_FILE@

SOURCES		= @WEBCAMSN_SOURCE@
OBJECTS 	= @WEBCAMSN_OBJECTS@


CC		= g++ -pipe

INCLUDES	= -I../src ${TCL_INC_SPEC} ${TK_INC_SPEC} 

CFLAGS    	= -O2  

CC_SWITCHS 	= ${CFLAGS} ${DEFINES} ${INCLUDES} 


LIBSN     	=  -L./ -lmimic ${TCL_STUB_LIB_SPEC} ${TK_STUB_LIB_SPEC}

.PHONY : all clean distclean 

all : ${OUTPUT} 

%.o: %.cpp
	$(CC) -c $(CC_SWITCHS) $<

libmimic.a : ../src/* ../Makefile
	cd ../ && make && cp src/.libs/libmimic.a webcamsn/ && cd webcamsn/

../Makefile :
	cd ../ && ./configure && cd webcamsn/

${OUTPUT}: ${OBJECTS} libmimic.a
	${SHLIB_LD} ${OBJECTS} $(LIBSN) -o $@ && cp ${OUTPUT} pkgIndex.tcl ../

${OBJECTS} : ${SOURCES} 

clean : 
	rm ${OBJECTS} libmimic.a ${OUTPUT} 2> /dev/null | true
	cd ../ && make clean && cd webcamsn/

distclean :
	rm -rf *~ ${OBJECTS} libmimic.a ${OUTPUT} config.* autom4te.cache 2>/dev/null | true
	cd ../ && make distclean && cd webcamsn/
